(function(e,t){typeof module=="object"&&typeof module.exports=="object"?(Terraformer=require("terraformer"),exports=module.exports=t()):typeof define=="function"&&define.amd?define(["terraformer/terraformer"],t):(typeof e.Terraformer=="undefined"&&(e.Terraformer={}),e.Terraformer.ArcGIS=t())})(this,function(){function t(e){var t=[],n;for(var r=0;r<e.length;r++){n=e[r];if(n.length>1)for(var i=0;i<n.length;i++)t.push(n[i]);else t.push(n[0])}return t}function n(e){if(e.x&&e.y)return"Point";if(e.points)return"MultiPoint";if(e.paths)return e.paths.length===1?"LineString":"MultiLineString";if(e.rings)return e.rings.length===1?"Polygon":"MultiPolygon";if(e.attributes&&e.geometry)return"Feature";throw"Terraformer: invalid ArcGIS input. Are you sure your data is properly formatted?"}function r(e){var t=n(e),i=e.geometry?e.geometry.spatialReference:e.spatialReference,s={type:t};t==="Feature"&&(s.properties=e.attributes);switch(t){case"Point":s.coordinates=[e.x,e.y];break;case"MultiPoint":s.coordinates=e.points;break;case"LineString":s.coordinates=e.paths[0];break;case"MultiLineString":s.coordinates=e.paths;break;case"Polygon":s.coordinates=e.rings;break;case"MultiPolygon":s.coordinates=e.rings;break;case"Feature":s.geometry=r(e.geometry)}return i.wkid===102100&&(s=Terraformer.toGeographic(s)),new Terraformer.Primitive(s)}function i(e,n){var r=n?n:{wkid:4326},s={};switch(e.type){case"Point":s.x=e.coordinates[0],s.y=e.coordinates[1],s.spatialReference=r;break;case"MultiPoint":s.points=e.coordinates,s.spatialReference=r;break;case"LineString":s.paths=[e.coordinates],s.spatialReference=r;break;case"MultiLineString":s.paths=e.coordinates,s.spatialReference=r;break;case"Polygon":s.rings=e.coordinates,s.spatialReference=r;break;case"MultiPolygon":s.rings=t(e.coordinates),s.spatialReference=r;break;case"Feature":s.geometry=i(e.geometry),s.attributes=e.properties}return s}var e={};return arguments[0]&&typeof define=="function"&&define.amd&&(this.Terraformer=arguments[0]),e.parse=r,e.convert=i,e});