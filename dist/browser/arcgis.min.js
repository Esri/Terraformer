(function(e,t){typeof module=="object"&&typeof module.exports=="object"&&(exports=module.exports=t()),typeof define=="function"&&define.amd&&define(["terraformer/terraformer"],t),typeof e.navigator=="object"&&(typeof e.Terraformer=="undefined"&&(e.Terraformer={}),e.Terraformer.ArcGIS=t())})(this,function(){function n(e){var t=[],n;for(var r=0;r<e.length;r++){n=e[r];for(var i=0;i<n.length;i++)t.push(n[i])}return t}function r(e,n){var r=t.Tools.arrayIntersectsArray(e,n),i=t.Tools.coordinatesContainPoint(e,n[0]);return!r&&i?!0:!1}function i(e){var t=[],n,i;for(var s=0;s<e.length;s++){n=e[s];var o=[n],u=!1;for(i=0;i<e.length;i++){var a=e[i];n!==a&&r(a,n)&&(u=!0)}if(u)continue;for(i=0;i<e.length;i++){var f=e[i];n!==e[i]&&r(n,f)&&o.push(e[i])}t.push(o)}return{type:"MultiPolygon",coordinates:t}}function s(e){var n={};e.x&&e.y&&(n.type="Point",n.coordinates=[e.x,e.y]),e.points&&(n.type="MultiPoint",n.coordinates=e.points),e.paths&&(e.paths.length===1?(n.type="LineString",n.coordinates=e.paths[0]):(n.type="MultiLineString",n.coordinates=e.paths)),e.rings&&(n=i(e.rings)),e.attributes&&e.geometry&&(n.type="Feature",n.geometry=s(e.geometry),n.properties=e.attributes);var r=e.geometry?e.geometry.spatialReference:e.spatialReference;return r&&r.wkid===102100&&(n=t.toGeographic(n)),new t.Primitive(n)}function o(e,t){var r=t?t:{wkid:4326},i={},s;switch(e.type){case"Point":i.x=e.coordinates[0],i.y=e.coordinates[1],i.spatialReference=r;break;case"MultiPoint":i.points=e.coordinates,i.spatialReference=r;break;case"LineString":i.paths=[e.coordinates],i.spatialReference=r;break;case"MultiLineString":i.paths=e.coordinates,i.spatialReference=r;break;case"Polygon":i.rings=e.coordinates,i.spatialReference=r;break;case"MultiPolygon":i.rings=n(e.coordinates),i.spatialReference=r;break;case"Feature":i.geometry=o(e.geometry),i.attributes=e.properties;break;case"FeatureCollection":i=[];for(s=0;s<e.features.length;s++)i.push(o(e.features[s]));break;case"GeometryCollection":i=[];for(s=0;s<e.geometries.length;s++)i.push(o(e.geometries[s]))}return i}var e={},t;return typeof this.navigator=="object"&&(t=this.Terraformer),typeof module=="object"&&typeof module.exports=="object"&&(t=require("terraformer")),arguments[0]&&typeof define=="function"&&define.amd&&(t=arguments[0]),e.parse=s,e.convert=o,e});